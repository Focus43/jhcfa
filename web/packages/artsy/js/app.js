!function(e,t){"use strict";t.module("artsy",["artsy.common","ngSanitize"]).config(["$provide","$locationProvider",function(){}]).run(["FastClick",function(e){e.attach(document.body);var t=document.querySelectorAll('[class*="wrap-theme-"]');if(t.length)for(var n=0,o=t.length;o>n;n++){for(var a=t[n];!a.classList.contains("container");)a=a.parentNode;a&&a.classList.add("overflowable-x")}}]),t.element(document).ready(function(){t.bootstrap(document.body,["artsy"])})}(window,window.angular),angular.module("artsy.common",[]),angular.module("artsy.common").controller("CtrlCalendarPage",["$scope","Schedulizer","moment",function(e,t,n){e.eventData=[],e.filters={fields:["calendarID"],keywords:null,calendars:"",tags:"",categories:1,filepath:!0,end:n().add(6,"months").format("YYYY-MM-DD"),attributes:"presenting_organization,date_display"},e.fetch=function(){t.fetch(e.filters).success(function(t){e.eventData=t}).error(function(){console.log("err")})},e.setCategory=function(t){e.filters.categories=t},e.fetch()}]),angular.module("artsy.common").controller("CtrlFeaturedEvents",["$scope","Schedulizer","moment",function(e,t,n){e.eventData=[],e.$watch("featuredTagID",function(o){o&&t.fetch({fields:["tags"],filepath:!0,limit:10,end:n().add(6,"months").format("YYYY-MM-DD"),attributes:"date_display",tags:o}).success(function(t){e.eventData=t})})}]),angular.module("artsy.common").provider("Modernizr",function(){this.$get=["$window","$log",function(e,t){return e.Modernizr||(t.warn("Modernizr unavailable!"),!1)}]}).provider("Tween",function(){this.$get=["$window","$log",function(e,t){return e.TweenMax||e.TweenLite||(t.warn("Greensock Tween library unavailable!"),!1)}]}).provider("moment",function(){this.$get=["$window","$log",function(e,t){return e.moment||(t.warn("MomentJS library unavailable!"),!1)}]}).provider("Masonry",function(){this.$get=["$window","$log",function(e,t){return e.Masonry||(t.warn("Masonry unavailable!"),!1)}]}).provider("imagesLoaded",function(){this.$get=["$window","$log",function(e,t){return e.imagesLoaded||(t.warn("imagesLoaded unavailable!"),!1)}]}).provider("FastClick",function(){this.$get=["$window","$log",function(e,t){return e.FastClick||(t.warn("FastClick unavailable!"),!1)}]}).provider("SVG",function(){this.$get=["$window","$log",function(e,t){return e.SVG||(t.warn("SVG.js unavailable!"),!1)}]}),angular.module("artsy.common").service("Schedulizer",["$http",function(e){function t(e,t){var n=e.concat(t);return n.filter(function(e,t){return n.indexOf(e)===t})}var n="/_schedulizer/event_list",o={fields:["computedStartLocal","computedStartUTC","title"],pagepath:!0,grouping:!0};this.fetch=function(a,r){var i=angular.extend({},a,{fields:t(a.fields||[],o.fields)});return e.get(n,{cache:r===!1?!1:!0,params:angular.extend({},o,i)})}}]),angular.module("artsy.common").directive("accordion",[function(){function e(e,t){var n=angular.element(t[0].querySelectorAll(".group"));n.on("click",function(){angular.element(this).toggleClass("active")})}return{restrict:"A",link:e}}]),angular.module("artsy.common").directive("eventList",["moment",function(e){function t(t,n,o,a,r){var i=[],c=[];t.$watch("_data",function(o){if(o){for(var a;a=i.pop();)a.remove();for(var l;l=c.pop();)l.$destroy();o.forEach(function(o){var a=t.$new();a.eventObj=o,a.moment=e(o.computedStartLocal),r(a,function(e,t){n.append(e),i.push(e),c.push(t)})})}},!0)}return{link:t,transclude:!0,scope:{_data:"=eventList"},controller:[function(){}]}}]),angular.module("artsy.common").directive("introAnim",["$rootScope","Tween",function(){function e(){}return{link:e,scope:!1}}]),angular.module("artsy.common").directive("masonry",["Masonry","imagesLoaded",function(e){function t(t,n){var o=n[0];t.masonry=new e(o,{itemSelector:"[node]",percentPosition:!0})}return{restrict:"A",scope:!0,link:t}}]),angular.module("artsy.common").directive("nav",["Tween",function(e){function t(t,n){var o,a=angular.element(document.documentElement),r=angular.element(n[0].querySelector(".majority"));t.status={open:!1},t.toggle=function(){t.status.open=!t.status.open},t.$watch("status.open",function(e){angular.element(document.documentElement).toggleClass("nav-open",e)}),angular.element(n[0].querySelectorAll(".sub-trigger")).on("click",function(){o=angular.element(this.parentNode.parentNode),o.toggleClass("sub-active"),r.toggleClass("show-subs")}),angular.element(n[0].querySelectorAll(".unsub")).on("click",function(){o.toggleClass("sub-active"),r.toggleClass("show-subs")});var i=0,c=50,l=!1;e.ticker.addEventListener("tick",function(){i!==window.pageYOffset&&(i=window.pageYOffset,i>c!==l&&(l=!l,a.toggleClass("dock-nav-icon",l)))})}return{restrict:"E",link:t}}]),angular.module("artsy.common").directive("scrollTo",["$window","$rootScope","Tween",function(e,t,n){function o(t,o,a){var r=document.querySelector(a.scrollTo);r&&o.on("click",function(t){t.preventDefault(),n.to(e,.65,{scrollTo:{y:r.offsetTop},ease:Power2.easeOut}),angular.element(o[0].parentNode.children).removeClass("active"),o.addClass("active")})}return{link:o,scope:!1}}]),angular.module("artsy.common").directive("searchable",["$http","$compile","$templateCache",function(e,t,n){function o(e,o){var a=angular.element(document.documentElement);t(o.contents())(e);var r=angular.element(n.get("/search-form-tpl")),i=t(r),c=i(e);angular.element(document.body).append(c),e.$watch("status.open",function(e,t){e!==t&&a.toggleClass("search-results-open",e)})}return{scope:{searchPath:"@searchable"},restrict:"A",link:o,controller:["$scope",function(t){t.pageHits=[],t.status={open:!1,value:"",displayValue:"",loading:!0},t.$watch("status.displayValue",function(e){t.status.open=e&&e.length>=1}),t.clear=function(){t.status.value="",t.status.displayValue=""},t.funcKeyup=function(e){t.status.displayValue=e.target.value,t.status.loading=!0},t.$watch("status.value",function(n){n&&t.searchForm.$valid&&e.get(t.searchPath,{cache:!1,params:{_s:t.status.value}}).success(function(e){t.pageHits=e.pages,t.status.loading=!1})})}]}}]),angular.module("artsy.common").directive("spokeTo",["$window","$rootScope","SVG","Tween",function(e,t,n,o){function a(e){var t=e.nodes[0].getBoundingClientRect(),n=e.nodes[1].getBoundingClientRect(),o=t.width/2,a=n.width/2,r=t.left+o,i=t.top+o,c=n.left+a,l=n.top+a,s=Math.atan2(l-i,c-r),f=Math.atan2(i-l,r-c),m=+e.attrs.spokeOffset||g,v=o+m,w=a+m,y=e.spoke,$=r+v*Math.cos(s),k=i+v*Math.sin(s),b=c+w*Math.cos(f),S=l+w*Math.sin(f);return y?(y.plot($,k,b,S),void 0):(e.spoke=u.line($,k,$,k).stroke({width:+e.attrs.spokeWidth||p,linecap:"round",dasharray:"0.1,"+(e.attrs.spokeDistance||h),color:"#ffffff"}),e.spoke.animate(400).during(function(e,t){this.attr({y2:t(k,S),x2:t($,b)})}).after(function(){d=!0}),void 0)}function r(e,t,n){m.push({nodes:[t[0].querySelector("circle"),document.querySelector(n.spokeTo).querySelector("circle")],attrs:n}),d=!0}var i=document.body,c=document.documentElement,l=document.body.getBoundingClientRect().width,s=Math.max(i.scrollHeight,i.offsetHeight,c.clientHeight,c.scrollHeight,c.offsetHeight),u=n(document.body),d=!1,f=!1,m=[],g=5,p=2,h=10;return u.size(l,s).attr("class","spoke-canvas"),o.ticker.addEventListener("tick",function(){if(d||f){for(var e=0,t=m.length;t>e;e++)a.call(this,m[e]);console.log("redrawn"),d=!1}}),angular.element(e).bind("scroll",function(){d=!0}),angular.element(e).bind("resize",function(){l=document.body.getBoundingClientRect().width,s=Math.max(i.scrollHeight,i.offsetHeight,c.clientHeight,c.scrollHeight,c.offsetHeight),u.size(l,s),d=!0}),t.$on("watchSpokes",function(e,t){f=t}),{link:r,scope:!1}}]);